---
title: "Gateway Architecture Overview"
description: "High-level map of the API gateway folders and their responsibilities."
---

This section documents how the gateway codebase is organized so you can quickly find where behavior is implemented.

## `apps/api/src` layout

| Folder | Purpose | Key files |
| --- | --- | --- |
| `apps/api/src/routes` | HTTP routing and endpoint registration. | `root.ts`, `v1/index.ts`, `v1/data/index.ts`, `v1/control/index.ts` |
| `apps/api/src/pipeline` | Request lifecycle (before/execute/after), pricing, usage, and audit. | `index.ts`, `before/`, `execute/`, `after/`, `audit/` |
| `apps/api/src/core` | Shared schemas, IR types, and low-level utilities used across layers. | `schemas.ts`, `ir.ts`, `types.ts`, `error-handler.ts` |
| `apps/api/src/protocols` | Protocol-specific decoding/encoding for OpenAI and Anthropic surfaces. | `openai-chat/`, `openai-responses/`, `anthropic-messages/` |
| `apps/api/src/providers` | Provider adapters and provider-specific endpoint mapping. | `openai/`, `openai-compatible/`, `anthropic/`, `google-ai-studio/` |
| `apps/api/src/runtime` | Environment bindings and runtime helpers. | `env.ts` |
| `apps/api/src/observability` | Wide-event telemetry emitters and privacy helpers. | `events.ts`, `axiom.ts`, `privacy.ts` |

## How requests flow

1. Routes register protocol-accurate endpoints under `apps/api/src/routes`.
2. Pipeline `before` validates auth/body/model and builds request context.
3. Pipeline `execute` selects an adapter and performs upstream calls.
4. Pipeline `after` formats protocol-specific responses, usage, and telemetry.
